# 全量测试（1G）

## 目的

通过随机，检查单元测试中没有测出的，藏得比较深的bug

## 实现

基本原理是进行多线程的读取写入删除，运行中不断的进行检查

### 如何检查

由于使用多线程，写入数值顺序无法固定
使用抽样的方法对数据进行检查，使用一个带锁的表结构，大小固定，写线程把需要检查的数据的key value写入这个表结构中，读线程循环逐个检查这个表
每次写入前判断是否需要检查（随机）

### 基本实现

#### 数据空间

读写线程使用一个随机数rand_id，每轮更新
写删除等操作=rand_id% 操作数量
key_id=rand_id%id_limit
key=str(key_id),value 随意，因为结果写入了检查表

### 写逻辑

更新随机数rand_id,
构造key，value
构建操作类型（写新数据/override/删除/删除不存在的数据）
判断是否需要进行检查 rand_id%（检查百分比）==0

### 读逻辑

逐个读取检查表，并进行检查

